<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>get_iplayer forums - Web PVR is downloading TV for Proms when I would expect it to download only radio</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="robots" content="index,follow" />
<link type="text/css" rel="stylesheet" rev="stylesheet" href="screen.css"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div class="frontnavwrap">
<div class="page-title">
<h1 style="color:#fff;">These forums are archived</h1>
<h3 style="color:#fff;">See <a style="color:#fff;" href="https://www.squarepenguin.co.uk/blog/squarepenguin-forums-archived/">this post</a> for further info</h3>
</div>
</div>
<nav class="navbar">
<div class="nav-container">
<ul class="">
<li> <a href="https://www.squarepenguin.co.uk/"> Home </a></li>
<li> <a href="https://www.squarepenguin.co.uk/blog/" class=""> Blog </a></li>
<li> <a href="https://www.squarepenguin.co.uk/features/" class=""> Features </a></li>
<li> <a href="https://www.squarepenguin.co.uk/faqs/" class=""> FAQ </a></li>
<li> <a href="https://www.squarepenguin.co.uk/downloads/" class=""> Downloads </a></li>
<li> <a href="https://www.squarepenguin.co.uk/wiki/" class=""> Wiki </a></li>
<li> <a href="https://www.squarepenguin.co.uk/guides/" class=""> Guides </a></li>
<li> <a href="https://forums.squarepenguin.co.uk/" class=""> Forums </a></li>
</ul>
</div>
</nav>
<div id="container">
<h1 class="forumtitle">get_iplayer forums</h1>
<h3 class="forumsubtitle">Forum archived. Posting disabled.</h3>
<div class="navigation"><a href="index.html">get_iplayer forums</a> &gt; <a href="forum-8.html">Windows Forums</a> &gt; <a href="forum-6.html">Windows Troubleshooting</a> &gt; Web PVR is downloading TV for Proms when I would expect it to download only radio</div>
<div id="pagetitle"><h2>Web PVR is downloading TV for Proms when I would expect it to download only radio</h2></div>
<div id="content">
<div class="post">
<div class="header">
<div class="author"><h2>user-2416</h2></div><div class="dateline">03-09-2019, 09:46 PM</div>
</div>
<div class="message">I am running Web PVR, trying to download some recent Prom radio programmes, and I find I am actually downloading both TV and radio. This is not a disaster but is a surprise and an unfortunate overuse of bandwidth. I would expect to see <span style="font-weight: bold;" class="mycode_b">type tv,radio</span> if I want to download both ... as I correctly see in other PVR searches.<br />
<br />
I am running Web PVR, and downloading via 'Run PVR'.  My PVR list includes an item prom_name_radio<br />
<br />
fields name<br />
fps25 0<br />
subtitles 0<br />
thumb 0<br />
<span style="font-weight: bold;" class="mycode_b">type radio</span><br />
search0 prom<br />
<br />
WHen I reach that point in my 'Run PVR' window I see the following, as of today:<br />
<br />
INFO: PVR Run: 'prom_name_radio'<br />
<br />
Matches:<br />
1030: BBC Proms: 2019 - Strauss, Sibelius and Prokofiev, BBC Four, m0007zff<br />
1031: BBC Proms: 2019 - Homage to Nina Simone, BBC Four, m0007zfh<br />
1033: BBC Proms: 2019 - Happy Birthday Henry Wood!, BBC Four, m00084zf<br />
1037: BBC Proms: Proms Encore 2019 - Episode 6, BBC Two, m0008593<br />
33912: BBC Proms 2019 on the World Service: BBC Proms 2019 - Painting pictures with orchestral colours, BBC World Service, w3csz53d<br />
33917: BBC Proms: 2019 Repeats - Prom 44: Belshazzar’s Feast, BBC Radio 3, m00083c2<br />
33954: BBC Proms: 2019 - Prom 55: Handel's Jephtha, BBC Radio 3, m0007yrs<br />
33955: BBC Proms: 2019 - Prom 57: Mozart, Rachmaninov and Qigang Chen, BBC Radio 3, m00083bx<br />
33956: BBC Proms: 2019 - Prom 58: Tchaikovsky, Janáček, Szymanowski and Linda Catlin Smith, BBC Radio 3, m00083c6<br />
33957: BBC Proms: 2019 - Prom 56: Henry Wood Tribute, BBC Radio 3, m00084c3<br />
33958: BBC Proms: 2019 - Proms at … Cadogan Hall 7: Silesian String Quartet, BBC Radio 3, m00084ck<br />
33959: BBC Proms: 2019 - Prom 59: Benvenuto Cellini, BBC Radio 3, m00084cr<br />
INFO: 12 matching programmes<br />
<br />
The first 4 of these are <span style="font-weight: bold;" class="mycode_b">TV</span> programs, and I would not expect to see them on my list.  This has occurred in other recent prom downloads - which I do every 4 or 5 days.<br />
<br />
Both iplayer and chrome are up-to-date, as is windows 10.<br />
<br />
Get_iplayer 3.22<br />
Chrome 76.0.3809.132 (Official Build) (64-bit)<br />
Microsoft Windows [Version 10.0.18362.295]<br />
<br />
Can anyone cast some light on this? Many thanks.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">04-09-2019, 11:12 AM</div>
</div>
<div class="message">Test your pvr search from the command line and <a href="thread-706.html#what-information-should-you-provide">follow our instructions</a>.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2416</h2></div><div class="dateline">05-09-2019, 05:15 PM</div>
</div>
<div class="message">I'd already read that 'how to' page, most of which applies to the command line options rather than the web interface - obviously. I have worked out that I need to run something like get_iplayer --pvr-single prom_name_radio --verbose &gt; "p:\prom.txt" 2&gt;&amp;1<br />
Nothing useful today because I'm up-to-date on  proms downloads.<br />
Given all downloads worked a couple of days ago, and are now on disk and in get_iplayer's history, I will have to wait for the next TV prom broadcast, so I can illustrate the problem. I'll be in touch again once I have that, probably at the weekend.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2416</h2></div><div class="dateline">16-09-2019, 11:42 AM</div>
</div>
<div class="message">OK, I have some new information.  When I run get_iplayer from the command line, it behaves as I would expect. I ran it yesterday. It found 13 radio programmes, and downloaded them correctly. I attach a log, as requested, named prom1509.txt<br />
The files were:<br />
BBC_Proms_2019_on_the_World_Service_BBC_Proms_2019_-_07._Ax_and_Haitink_play_Beethoven_w3csz53g_original.m4a<br />
BBC_Proms_2012_-_Cameron_Carpenter_Organ_Recital_1_2_b01pcrzz_original.m4a<br />
BBC_Proms_2019_-_Prom_71_Bach_Night_m00087n7_original.m4a<br />
BBC_Proms_2019_-_Prom_69_Smetana_Shostakovich_and_Tchaikovsky_m0008930_original.m4a<br />
BBC_Proms_2019_-_Prom_70_Jonny_Greenwood_m0008932_original.m4a<br />
BBC_Proms_2019_-_Prom_72_Symphonie_fantastique_m0008b7d_original.m4a<br />
BBC_Proms_2019_-_Proms_Poetry_Competition_m0008b7j_original.m4a<br />
BBC_Proms_2019_-_Prom_74_Beethoven_Night_m0008bgm_original.m4a<br />
BBC_Proms_2019_-_Prom_75_Last_Night_of_the_Proms_m0008h24_original.m4a<br />
Proms_in_the_Park_-__m0008gf2_original.m4a<br />
Proms_in_the_Park_-_2019_m0008gyr_original.m4a<br />
Proms_in_the_Park_-_Proms_in_the_Park_2019_Live_from_Swansea_m0008gzg_original.m4a<br />
Proms_in_the_Park_-_2019-09-14_m0008hg6_original.m4a<br />
<br />
I ran it again, and (correctly) got no downloads at all (prom1509b.txt)<br />
I then returned to web PVR.  I ran that, got a few other unrelated downloads, but no downloads for 'prom_name_radio' (evidence copied from web page):<br />
INFO: PVR Run: 'planets_name_tv_radio'<br />
INFO: PVR Run: 'prom_name_radio'<br />
INFO: PVR Run: 'qi_name_tv'<br />
<br />
HOWEVER I left 'run PVR' running. In the middle of the night, when I got up for a pee, web PVR had detected 8 proms downloads, all TV. It had downloaded two and was part way through a third.  I simply closed down get_iplayer.  I deleted the part-download (a .ts and a .txt file).<br />
<br />
I then restarted web PVR. I selected 'recordings' and deleted the two TV downloads - Jonny Greenwood Curates and Berlioz's Symphonie fantastique - and then I ran 'Run PVR' and got NO downloads. Good, I thought.  Again, I left it running overnight.<br />
<br />
I am now back in front of the computer and it's downloading more TV proms. I notice the URL is now http://localhost:1935/?NEXTPAGE=pvr_run&amp;AUTOPVRRUN=4<br />
<br />
from the web page:<br />
<br />
INFO: PVR Run: 'prom_name_radio'<br />
<br />
Matches:<br />
1023:	BBC Proms: 2019 - Last Night of the Proms, part 2, BBC One, m0008l8w<br />
1024:	BBC Proms: 2019 - Last Night of the Proms, Part 1, BBC Two, m0008ldd<br />
1025:	BBC Proms: 2019 - Proms in the Park – Live from Glasgow, BBC Scotland, m0008mn4<br />
1026:	BBC Proms: 2019 - Proms in the Park – Live from Swansea, BBC Two, m0008mnt<br />
1027:	BBC Proms: 2019 - Proms in the Park – Swansea Highlights, BBC Two, m0008n9v<br />
1701:	CBeebies Prom: Off to the Moon - -, CBeebies, m0008lvt<br />
INFO: 6 matching programmes<br />
<br />
INFO: Downloading tv: 'BBC Proms: 2019 - Last Night of the Proms, part 2 (m0008l8w) [original]'<br />
##############################################################<br />
<br />
I have no doubt if I leave it, I will end up downloading six TV proms episodes.<br />
<br />
My conclusion is there is a bug, which only appears when 'Run PVR' repeats itself after 4 or more hours. The command line and first run of 'run PVR' behave impeccably, downloading only the radio programmes I want. I *think* the problem only occurs when 'run PVR' repeats itself. <br />
<br />
If you can explain how I can create a verbose log via the *web* interface, I can provide more information.<br/><br/>
<a href="static/thread-2090-prom1509.txt">prom1509.txt</a><br/>
<a href="static/thread-2090-prom1509b.txt">prom1509b.txt</a>

</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">16-09-2019, 01:33 PM</div>
</div>
<div class="message">Add a line reading "verbose 1" in the "prom_name_radio" file containing your pvr search for verbose output. Also add a line reading "test 1" to avoid actually downloading any files.You only need to test the search. You can also use <kbd>--pvr-scheduler=14400</kbd> to run pvr list from the command line.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2416</h2></div><div class="dateline">16-09-2019, 04:41 PM</div>
</div>
<div class="message">Thanks for the info. Will do.  The proms have ended, but I'll remove some files (from download_history, so they will retrigger when I next search) and I'll have scope for further testing.<br />
[short pause]<br />
1) Deleted 4 'proms in the park' from download_history, along with the two aforementioned TV downloads.<br />
2) Added<br />
<span style="font-weight: bold;" class="mycode_b">verbose 1<br />
test 1</span><br />
to proms_name_radio<br />
3) ran <span style="font-weight: bold;" class="mycode_b">get_iplayer --pvr-single prom_name_radio &gt; "p:\prom1609.txt" 2&gt;&amp;1</span> from the command line<br />
Reading 1609.txt, unsurprisingly I find 4 matched radio programmes and no matched TV.<br />
<span style="font-weight: bold;" class="mycode_b">INFO: Loaded history for first check.<br />
INFO: Loading recordings history<br />
Matches:<br />
41786: Proms in the Park - -, BBC Radio Scotland, m0008gf2<br />
41787: Proms in the Park - 2019, BBC Radio Foyle, m0008gyr<br />
41788: Proms in the Park - Proms in the Park 2019, Live from Swansea, BBC Radio Wales, m0008gzg<br />
41789: Proms in the Park - 14/09/2019, BBC Radio 2, m0008hg6<br />
INFO: 4 matching programmes</span><br />
<br />
More to follow on --pvr-scheduler ... but can I assume it's safe to try =900 in order to save testing time?<br/><br/>
<a href="static/thread-2090-prom1609.txt">prom1609.txt</a>
</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">16-09-2019, 04:48 PM</div>
</div>
<div class="message"><blockquote class="mycode_quote"><cite><span> (16-09-2019, 04:41 PM)</span></cite>More to follow on --pvr-scheduler ... but can I assume it's safe to try =900 in order to save testing time?</blockquote>The minimum interval with <kbd>--pvr-scheduler</kbd> is 1800 secs (30 mins), unless you alter get_iplayer itself. You can use a smaller interval in web pvr by specifying a fractional value in Auto-Run PVR Interval, e.g., 0.05 would be about 3 mins.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2416</h2></div><div class="dateline">18-09-2019, 11:09 PM</div>
</div>
<div class="message">I ran get_iplayer from the command line get_iplayer --pvr-scheduler=1800 --verbose &gt; "p:\prom1809.txt" 2&gt;&amp;1<br />
<br />
I let it run twice through and on both occasions I got 11 matches where I would have hoped for only four<br />
<br />
1015:	BBC Proms: 2019 - Berlioz's Symphonie fantastique, BBC Four, m0008c35<br />
1016:	BBC Proms: 2019 - Jonny Greenwood Curates, BBC Four, m0008c37<br />
1019:	BBC Proms: 2019 - Last Night of the Proms, Part 1, BBC Two, m0008ldd<br />
1020:	BBC Proms: 2019 - Proms in the Park &amp;#x2013; Live from Glasgow, BBC Scotland, m0008mn4<br />
1021:	BBC Proms: 2019 - Proms in the Park &amp;#x2013; Live from Swansea, BBC Two, m0008mnt<br />
1022:	BBC Proms: 2019 - Proms in the Park &amp;#x2013; Swansea Highlights, BBC Two, m0008n9v<br />
1704:	CBeebies Prom: Off to the Moon - -, CBeebies, m0008lvt<br />
41820:	Proms in the Park - -, BBC Radio Scotland, m0008gf2<br />
41821:	Proms in the Park - 2019, BBC Radio Foyle, m0008gyr<br />
41822:	Proms in the Park - Proms in the Park 2019, Live from Swansea, BBC Radio Wales, m0008gzg<br />
41823:	Proms in the Park - 14/09/2019, BBC Radio 2, m0008hg6<br />
INFO: 11 matching programmes<br />
<br />
The log is attached. <br />
<br />
In  'prom_name_radio' I had left test=1 to suppress those TV downloads ... but other PVR searches matched and downloaded as I would expect.<br />
<br />
I am going to revert to normal settings and timings, and I'll leave the program running overnight, downloading whatever it thinks is right ... and I'll report on that tomorrow.<br />
<br />
However I'm pretty sure further verbose logs won't help you much because I suspect the problem lies within the routines to match a search against the database ...</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">18-09-2019, 11:11 PM</div>
</div>
<div class="message">No log attached</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2416</h2></div><div class="dateline">18-09-2019, 11:41 PM</div>
</div>
<div class="message">... and in the meantime, from the prom1809.txt log ... (selective content)<br />
<br />
INFO: PVR Run: 'prom_name_radio'<br />
...<br />
	type = radio<br />
...<br />
<br />
INFO: Got (quick) 25557 memcache entries for radio<br />
...<br />
<br />
Matches:<br />
1015:	BBC Proms: 2019 - Berlioz's Symphonie fantastique, BBC Four, m0008c35<br />
1016:	BBC Proms: 2019 - Jonny Greenwood Curates, BBC Four, m0008c37<br />
1019:	BBC Proms: 2019 - Last Night of the Proms, Part 1, BBC Two, m0008ldd<br />
1020:	BBC Proms: 2019 - Proms in the Park &amp;#x2013; Live from Glasgow, BBC Scotland, m0008mn4<br />
1021:	BBC Proms: 2019 - Proms in the Park &amp;#x2013; Live from Swansea, BBC Two, m0008mnt<br />
1022:	BBC Proms: 2019 - Proms in the Park &amp;#x2013; Swansea Highlights, BBC Two, m0008n9v<br />
1704:	CBeebies Prom: Off to the Moon - -, CBeebies, m0008lvt<br />
41820:	Proms in the Park - -, BBC Radio Scotland, m0008gf2<br />
41821:	Proms in the Park - 2019, BBC Radio Foyle, m0008gyr<br />
41822:	Proms in the Park - Proms in the Park 2019, Live from Swansea, BBC Radio Wales, m0008gzg<br />
41823:	Proms in the Park - 14/09/2019, BBC Radio 2, m0008hg6<br />
INFO: 11 matching programmes<br />
<br />
I did NOT see INFO: Got (quick) 7830 memcache entries for tv  - despite that, a number of TV programmes show up as matches.<br />
<br />
Two possibilities strike me<br />
1) one of get_iplayer parameters is interfering with the search<br />
2) the search is sometimes including the TV cache (unannounced) when it shouldn't.<br />
<hr class="mycode_hr" />
? no log attached. Hmm. I'll try again.<br/><br/>
<a href="static/thread-2090-prom1809.txt">prom1809.txt</a>
</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2416</h2></div><div class="dateline">19-09-2019, 10:33 AM</div>
</div>
<div class="message">I left get_iplayer running overnight:<br />
get_iplayer --pvr-scheduler=14400 --verbose &gt; "p:\prom1909.txt" 2&gt;&amp;1<br />
<br />
Executive summary:<br />
On the first run through, the program correctly found and downloaded 4 proms radio programmes. On the next run through, it found and downloaded a further 7 proms programs, this time TV.  Scroll to about line 4800 in the attached log.<br />
It looks to me like the program is finding and using the TV cache ... shouldn't be happening, obviously. Must be something hidden in the regex search routines? A guess.<br/><br/>
<a href="static/thread-2090-prom1909.txt">prom1909.txt</a>
</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">19-09-2019, 01:41 PM</div>
</div>
<div class="message">Thanks. I can replicate the problem now. There is a bug in the cache refresh between pvr passes. It will be fixed in the next release. Since the Proms are finished, this shouldn't affect you directly any further, though the problem may appear for similar pvr searches with <kbd>--type=radio</kbd> that that capture both tv and radio programmes.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2416</h2></div><div class="dateline">19-09-2019, 02:25 PM</div>
</div>
<div class="message">Glad to be able to help with what is a superb and superbly useful program.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">30-11-2019, 12:43 AM</div>
</div>
<div class="message">fixed in v3.23</div>
</div>
</div>
<div class="navigation"><a href="index.html">get_iplayer forums</a> &gt; <a href="forum-8.html">Windows Forums</a> &gt; <a href="forum-6.html">Windows Troubleshooting</a> &gt; Web PVR is downloading TV for Proms when I would expect it to download only radio</div>
</div>
<div class="footer">
<div class="footer-text">
<p class="footernote"> Site design Copyright &copy; SquarePenguin; <a href="http://creativecommons.org/licenses/by/4.0/">some rights reserved.</a></p>
<p class="footernote"><a href="https://www.squarepenguin.co.uk/attribution/">Attribution of Licensed Works</a></p>
</div>
</div>
<div class="frontnavwrap">
<div class="page-title">
<h1 style="color:#fff;">These forums are archived</h1>
<h3 style="color:#fff;">See <a style="color:#fff;" href="https://www.squarepenguin.co.uk/blog/squarepenguin-forums-archived/">this post</a> for further info</h3>
</div>
</div>
</body>
</html>

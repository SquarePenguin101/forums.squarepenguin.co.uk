<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>get_iplayer forums - &quot;Segment not found&quot; error and audio sync problems</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="robots" content="index,follow" />
<link type="text/css" rel="stylesheet" rev="stylesheet" href="screen.css"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div class="frontnavwrap">
<div class="page-title">
<h1 style="color:#fff;">These forums are archived</h1>
<h3 style="color:#fff;">See <a style="color:#fff;" href="https://www.squarepenguin.co.uk/blog/squarepenguin-forums-archived/">this post</a> for further info</h3>
</div>
</div>
<nav class="navbar">
<div class="nav-container">
<ul class="">
<li> <a href="https://www.squarepenguin.co.uk/"> Home </a></li>
<li> <a href="https://www.squarepenguin.co.uk/blog/" class=""> Blog </a></li>
<li> <a href="https://www.squarepenguin.co.uk/features/" class=""> Features </a></li>
<li> <a href="https://www.squarepenguin.co.uk/faqs/" class=""> FAQ </a></li>
<li> <a href="https://www.squarepenguin.co.uk/downloads/" class=""> Downloads </a></li>
<li> <a href="https://www.squarepenguin.co.uk/wiki/" class=""> Wiki </a></li>
<li> <a href="https://www.squarepenguin.co.uk/guides/" class=""> Guides </a></li>
<li> <a href="https://forums.squarepenguin.co.uk/" class=""> Forums </a></li>
</ul>
</div>
</nav>
<div id="container">
<h1 class="forumtitle">get_iplayer forums</h1>
<h3 class="forumsubtitle">Forum archived. Posting disabled.</h3>
<div class="navigation"><a href="index.html">get_iplayer forums</a> &gt; <a href="forum-16.html">General Forums</a> &gt; <a href="forum-15.html">General Topics </a> &gt; &quot;Segment not found&quot; error and audio sync problems</div>
<div id="pagetitle"><h2>&quot;Segment not found&quot; error and audio sync problems</h2></div>
<div id="content">
<div class="post">
<div class="header">
<div class="author"><h2>user-1209</h2></div><div class="dateline">03-08-2016, 06:18 AM</div>
</div>
<div class="message">Could someone please check for me. Is the hlshd1 version of b07myxws corrupt? On download I keep getting the following error messages every time I try, and at the same segments....<br />
<br />
WARNING: Segment not found (32) <a href="http://cp401489-vh.akamaihd.net/i/iplayerstream/">http://cp401489-vh.akamaihd.net/i/iplayerstream/</a><br />
secure_auth/,800kbps/modav/bUnknown-7589b24b-274b-4d67-b0d5-2471c6a51bfa_b07myxt<br />
z_1469905806580,1500kbps/modav/bUnknown-7589b24b-274b-4d67-b0d5-2471c6a51bfa_b07<br />
myxtz_1469905809775,3200kbps/modav/bUnknown-7589b24b-274b-4d67-b0d5-2471c6a51bfa<br />
_b07myxtz_1469905806343,.mp4.csmil/segment32_2_av.ts<br />
WARNING: There may be a gap near 310 secs in programme<br />
Recording:   809.34MB / 1007.32MB 30838kbps  80.3% 00:00:52 remaining<br />
WARNING: Segment not found (274) <a href="http://cp401489-vh.akamaihd.net/i/iplayerstream">http://cp401489-vh.akamaihd.net/i/iplayerstream</a><br />
/secure_auth/,800kbps/modav/bUnknown-7589b24b-274b-4d67-b0d5-2471c6a51bfa_b07myx<br />
tz_1469905806580,1500kbps/modav/bUnknown-7589b24b-274b-4d67-b0d5-2471c6a51bfa_b0<br />
7myxtz_1469905809775,3200kbps/modav/bUnknown-7589b24b-274b-4d67-b0d5-2471c6a51bf<br />
a_b07myxtz_1469905806343,.mp4.csmil/segment274_2_av.ts<br />
WARNING: There may be a gap near 2730 secs in programme<br />
Recording:   983.70MB / 1007.32MB 30758kbps  97.7% 00:00:06 remaining<br />
WARNING: Segment not found (333) <a href="http://cp401489-vh.akamaihd.net/i/iplayerstream">http://cp401489-vh.akamaihd.net/i/iplayerstream</a><br />
/secure_auth/,800kbps/modav/bUnknown-7589b24b-274b-4d67-b0d5-2471c6a51bfa_b07myx<br />
tz_1469905806580,1500kbps/modav/bUnknown-7589b24b-274b-4d67-b0d5-2471c6a51bfa_b0<br />
7myxtz_1469905809775,3200kbps/modav/bUnknown-7589b24b-274b-4d67-b0d5-2471c6a51bf<br />
a_b07myxtz_1469905806343,.mp4.csmil/segment333_2_av.ts<br />
WARNING: There may be a gap near 3320 secs in programme<br />
<br />
Or is it something else?</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1200</h2></div><div class="dateline">03-08-2016, 09:16 AM</div>
</div>
<div class="message">I've downloaded 14 shows this morning; most of them had the issue you described above. The videos look intact, but the audio is completely out of sync in each one.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1209</h2></div><div class="dateline">03-08-2016, 09:32 AM</div>
</div>
<div class="message">Yes, exactly. The audio is out of sync after the missing video segment. Which is what you might expect if the video is missing but the audio is intact.  Strange. I am wondering if this has been caused by the downloading process, or whether the BBC's mp4 encoding of the original broadcast video is faulty. Any ideas?</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">03-08-2016, 10:45 AM</div>
</div>
<div class="message">"Segment not found" signifies a production error at the BBC end. There is nothing get_iplayer can do about it. You can either wait a while to see if it gets fixed, or just use a different recording mode.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1200</h2></div><div class="dateline">03-08-2016, 11:01 AM</div>
</div>
<div class="message">Hi user-2,<br />
<br />
Sorry, I'm a bit of a newbie; when you say "use a different recording mode", what do you mean?  I'm just running get_iplayer like this, e.g.:<br />
<br />
get_iplayer "http://www.bbc.co.uk/iplayer/episode/b03qkzbp/sacred-wonders-of-britain-episode-3"</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1026</h2></div><div class="dateline">03-08-2016, 02:10 PM</div>
</div>
<div class="message">^^ <kbd>get_iplayer --pid=b03qkzbp --info</kbd><br />
<br />
That will show you the <kbd>--versions</kbd> (such as <kbd>audiodescribed</kbd> and <kbd>original</kbd>) and the <kbd>--modes</kbd> (such as <kbd>hlshd1</kbd> and <kbd>hlsstd1</kbd>).<br />
<br />
Then you can use the <kbd>--versions</kbd> &amp; <kbd>--modes</kbd> options to select the one you are after.<br />
<br />
More info <a href="https://squarepenguin.co.uk/wiki/documentation/">here</a>.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1209</h2></div><div class="dateline">03-08-2016, 02:30 PM</div>
</div>
<div class="message">Dinky thanks. An analysis of the downloaded mp4 tells me that the video is running at 24.79fps. Normally these files are standard 25fps. A closer looks reveals the audio gradually gets ahead of the picture, so my guess is the mp4 was encoded from audio running at 25fps and picture at 24.79fps.  Which makes these items unviewable.  What is odd is that the SD and HD versions when viewed directly on iPlayer are both perfect.  No issues.  I am now testing all available versions and will report back.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1200</h2></div><div class="dateline">03-08-2016, 02:32 PM</div>
</div>
<div class="message">Many thanks for the explanation.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">03-08-2016, 03:22 PM</div>
</div>
<div class="message">Who knows? Supposedly, the various stream formats are created from the same source media, so you would guess the problem is in the segmenting rather than the encoding. OTOH, the fact that you get the "right" amount of audio even though chunks of the stream are missing suggests that maybe it was in fact created from a duff source. Streams with this problem have been fixed before by the  BBC, so waiting a while may be all it takes.<br />
<br />
The iPlayer site uses HDS or DASH, and you can't compare like-for-like with the HLS streams get_iplayer uses. When you click "Watch in HD" on the web site, you don't get a 1280x720 25fps HDS/DASH stream equivalent to what get_iplayer refers to as "hlshd". get_iplayer prefers the video streams that include "hlshd" in order to keep the default HD stream at 25fps. It may be just that particular processing pipeline that has a problem. <br />
<br />
If it proves to be a long-lived problem, I'll just drop the problem streams. I don't want to do that without good reason because then the only 720p option is the 50fps streams, which is unnecessary and pretty bloated for most programmes. If I do that, I'll probably dial back the default quality level to the 960x540 version you get with "Watch in HD".<br />
<br />
EDIT: removed incorrect info about mobile device streams</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1209</h2></div><div class="dateline">03-08-2016, 03:29 PM</div>
</div>
<div class="message">OK, regarding the "segment not found issue", from a typical one 1-hour programme I tested the following modes and file sizes (I only go for the highest quality downloads, especially in 50p)....<br />
<br />
using "--modes="<br />
<br />
mode - filesize - actual fps - status<br />
hvfhd1 - 2364Mb - 50p - ok<br />
hvfsd1 - 1337Mb - 50p - ok<br />
flashhd1 - 1010Mb - 25p - ok<br />
hlshd1 - 1023Mb - 24.79p - out of sync<br />
<br />
So for me, it seems that all is ok except the hlshd1 mode. I cannot comment on any lower resolutions.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">03-08-2016, 03:33 PM</div>
</div>
<div class="message"><blockquote class="mycode_quote"><cite><span> (03-08-2016, 03:29 PM)</span></cite>So for me, it seems that all is ok except the hlshd1 mode.</blockquote>That is true for all reports to date.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1209</h2></div><div class="dateline">04-08-2016, 05:58 AM</div>
</div>
<div class="message">The hlshd sync problem persists with last night's shows too. So for 1280x720/25p resolution flashhd FLV seems to be the only reliable mode for me at the moment. However, why does the flashhd FLV version consistently download much more slowly than the hlshd TS version, even though the file sizes are very similar?</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1146</h2></div><div class="dateline">04-08-2016, 12:57 PM</div>
</div>
<div class="message">Yes I have this problem.<br />
<br />
Am running linux version 2.95 and have had no problems at all until several days ago.<br />
<br />
when playing after download, video (not audio) freezes for several seconds resulting in video/audio sync problem.<br />
<br />
This can happen in different parts of the video.<br />
<br />
I keep all my log files, below is a sample of this happening (this one happened today).<br />
<br />
-------- example output from player.log -------------------<br />
.<br />
.<br />
.<br />
Recording:    95.80MB / 747.63MB  6084kbps  12.8% 00:14:37 remaining<br />
Recording:    96.55MB / 747.63MB  6084kbps  12.9% 00:14:36 remaining<br />
Recording:    97.30MB / 747.63MB  6085kbps  13.0% 00:14:35 remaining<br />
Recording:    98.05MB / 747.63MB  6085kbps  13.1% 00:14:34 remaining<br />
WARNING: Segment not found (33) <a href="http://cp401489-vh.akamaihd.net/i/iplayerstream/secure_auth/,800kbps/modav/bUnknown-2522a703-5b14-4f58-ba75-df34641e3f9a_b061z8ww_1435752182107,1500kbps/modav/bUnknown-2522a703-5b14-4f58-ba75-df34641e3f9a_b061z8ww_1435752184155,3200kbps/modav/bUnknown-2522a703-5b14-4f58-ba75-df34641e3f9a_b061z8ww_1435758480141,.mp4.csmil/segment33_2_av.ts">http://cp401489-vh.akamaihd.net/i/iplaye...33_2_av.ts</a><br />
WARNING: There may be a gap near 320 secs in programme<br />
Recording:    98.80MB / 747.63MB  6040kbps  13.2% 00:14:40 remaining<br />
Recording:    99.55MB / 747.63MB  6041kbps  13.3% 00:14:38 remaining<br />
Recording:   100.29MB / 747.63MB  6041kbps  13.4% 00:14:37 remaining<br />
Recording:   101.04MB / 747.63MB  6042kbps  13.5% 00:14:36 remaining<br />
.<br />
.<br />
.<br />
-------------- end of player.log example output --------------<br />
<br />
hope this helps in identifying the problem.<br />
<br />
-- showman</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1146</h2></div><div class="dateline">04-08-2016, 01:47 PM</div>
</div>
<div class="message">Re: the sync problem<br />
<br />
below is the get_iplayer output for downloading the latest episode of fleabag.<br />
<br />
I re-downloaded it (using --force) to see if the problem occurs in the same place.<br />
<br />
It does - re- downloading the same program (i.e. same pid) produces the error in the same place for that program.<br />
<br />
here is the output  (linux version of get_iplayer 2.95 with newest updates)<br />
<br />
----------------------------<br />
get_iplayer 2.95-7-g9986f11-ppa26, Copyright (C) 2008-2010 Phil Lewis<br />
  This program comes with ABSOLUTELY NO WARRANTY; for details use --warranty.<br />
  This is free software, and you are welcome to redistribute it under certain<br />
  conditions; use --conditions for details.<br />
<br />
INFO: Episode-only pid detected<br />
INFO: Trying pid: p042khwn using type: tv<br />
INFO: Trying to stream pid using type tv<br />
INFO: pid not found in tv cache<br />
Matches:<br />
<br />
INFO: 1 Matching Programmes<br />
INFO: Checking existence of iplayer version<br />
INFO: hlshd1,hlsvhigh1,hlshigh1,hlsstd1,hlslow1 modes will be tried for version iplayer<br />
INFO: Trying hlshd1 mode to record tv: Fleabag - 3. Episode 3<br />
INFO: File name prefix = Fleabag_-_3._Episode_3_p042khwn_iplayer                 <br />
INFO: Begin recording file: /home/glyn/tb1/bbc/Fleabag_-_3._Episode_3_p042khwn_iplayer.partial.mp4.ts<br />
Recording:   361.49MB / 446.53MB  6715kbps  81.0% 00:01:43 remaining<br />
WARNING: Segment not found (123) <a href="http://cp401489-vh.akamaihd.net/i/iplayerstream/secure_auth/,800kbps/modav/bUnknown-31958691-cd58-4d31-94c2-0e63b8cf5b23_p042kj50_1469489887587,1500kbps/modav/bUnknown-31958691-cd58-4d31-94c2-0e63b8cf5b23_p042kj50_1469489888508,3200kbps/modav/bUnknown-31958691-cd58-4d31-94c2-0e63b8cf5b23_p042kj50_1469489885443,.mp4.csmil/segment123_2_av.ts">http://cp401489-vh.akamaihd.net/i/iplaye...23_2_av.ts</a><br />
WARNING: There may be a gap near 1220 secs in programme<br />
INFO: Recorded: 460.26MB in 00:09:22 at  6709kbps to /home/glyn/tb1/bbc/Fleabag_-_3._Episode_3_p042khwn_iplayer.partial.mp4.ts<br />
INFO: Begin converting file: /home/glyn/tb1/bbc/Fleabag_-_3._Episode_3_p042khwn_iplayer.partial.mp4.ts<br />
[h264 @ 0x1b145c0] non-existing SPS 0 referenced in buffering period<br />
[h264 @ 0x1b145c0] non-existing SPS 32 referenced in buffering period<br />
[h264 @ 0x1b145c0] non-existing SPS 0 referenced in buffering period<br />
[h264 @ 0x1b145c0] non-existing SPS 32 referenced in buffering period<br />
[NULL @ 0x1b145c0] non-existing SPS 0 referenced in buffering period<br />
[NULL @ 0x1b145c0] non-existing SPS 32 referenced in buffering period<br />
INFO: Converted file: /home/glyn/tb1/bbc/Fleabag_-_3._Episode_3_p042khwn_iplayer.partial.mp4<br />
INFO: Recorded file: /home/glyn/tb1/bbc/Fleabag_-_3._Episode_3_p042khwn_iplayer.mp4<br />
<br />
INFO: MP4 tagging MP4 file<br />
<br />
 Started writing to temp file.<br />
 Progress: =======================================================&gt;100% |<br />
 Finished writing to temp file.<br />
<br />
<br />
<br />
----------------------------<br />
<br />
-- showman</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">04-08-2016, 03:53 PM</div>
</div>
<div class="message">Closing this thread to avoid any more "me too" posts.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-2</h2></div><div class="dateline">05-08-2016, 12:14 PM</div>
</div>
<div class="message">After looking at a few more cases, it appears to me that audio sync problems are a by-product of re-muxing the downloaded MPEG-TS files to MP4 with ffmpeg, which must get confused by timestamp discontinuities. You can download with <kbd>--raw</kbd> and get a playable MPEG-TS file, though it's still better just to change your recording mode so you can get a complete download.</div>
</div>
<div class="post">
<div class="header">
<div class="author"><h2>user-1379</h2></div><div class="dateline">17-08-2016, 03:53 PM</div>
</div>
<div class="message">hi guys,<br />
<br />
excellent app and it seems to work, at first.<br />
<br />
it downloads videos with a few gaps and other errors logged.<br />
<br />
i've attached the verbose log file.<br />
<br />
the video plays with sound but it's out of sync.<br />
<br />
i've been unable to find the issue mentioned on the various support pages or this forum.<br />
<br />
is there a quick/easy way to fix this?<br />
<br />
thanks in advance for any assistance</div>
</div>
</div>
<div class="navigation"><a href="index.html">get_iplayer forums</a> &gt; <a href="forum-16.html">General Forums</a> &gt; <a href="forum-15.html">General Topics </a> &gt; &quot;Segment not found&quot; error and audio sync problems</div>
</div>
<div class="footer">
<div class="footer-text">
<p class="footernote"> Site design Copyright &copy; SquarePenguin; <a href="http://creativecommons.org/licenses/by/4.0/">some rights reserved.</a></p>
<p class="footernote"><a href="https://www.squarepenguin.co.uk/attribution/">Attribution of Licensed Works</a></p>
</div>
</div>
<div class="frontnavwrap">
<div class="page-title">
<h1 style="color:#fff;">These forums are archived</h1>
<h3 style="color:#fff;">See <a style="color:#fff;" href="https://www.squarepenguin.co.uk/blog/squarepenguin-forums-archived/">this post</a> for further info</h3>
</div>
</div>
</body>
</html>
